<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Blunderfish</title>
    <link rel="stylesheet" href="/src/styles.css" />
  </head>
  <body>
    <section id="mode-select-screen" class="mode-screen" aria-label="Game mode selection">
      <div class="mode-card">
        <p class="mode-kicker">Choose a game mode</p>
        <h1 class="mode-title">Pick Your Fish</h1>
        <p class="mode-subtitle">Max-strength Stockfish, but with chaotic twists.</p>
        <div class="mode-options">
          <button id="mode-blunderfish-btn" class="mode-button" type="button">
            <span class="mode-name">Blunderfish</span>
            <span class="mode-description">Max difficulty stockfish but it is forced to randomly play blunders</span>
          </button>
          <button id="mode-blindfish-btn" class="mode-button mode-button-secondary" type="button">
            <span class="mode-name">Blindfish</span>
            <span class="mode-description">Max difficulty stockfish but it randomly forgets about pieces</span>
          </button>
          <button id="mode-rampfish-btn" class="mode-button mode-button-tertiary" type="button">
            <span class="mode-name">Clapbackfish</span>
            <span class="mode-description">Makes the comeback of the century</span>
          </button>
        </div>
        <p id="mode-select-note" class="mode-note" aria-live="polite"></p>
      </div>
    </section>

    <section id="setup-screen" class="mode-screen" aria-label="Game setup" hidden>
      <div class="mode-card">
        <p class="mode-kicker">Game setup</p>
        <h1 id="setup-title" class="mode-title">Blunderfish Settings</h1>
        <p id="setup-subtitle" class="mode-subtitle">Tune settings before the game starts.</p>
        <p id="setup-first-game-hint" class="setup-hint" hidden>If this is your first game, use the default settings!</p>

        <div id="setup-blunder-settings" class="setup-mode-settings">
          <label class="setting-label" for="setup-blunder-slider">Blunder Chance</label>
          <div class="setting-row">
            <input
              id="setup-blunder-slider"
              class="dilution-slider"
              type="range"
              min="0"
              max="100"
              step="1"
              value="20"
            />
            <span id="setup-blunder-value">20%</span>
          </div>
          <label class="setting-checkbox">
            <input id="setup-reveal-blunders" type="checkbox" checked />
            <span>Reveal Blunders</span>
          </label>
        </div>

        <div id="setup-blind-settings" class="setup-mode-settings" hidden>
          <label class="setting-label" for="setup-blind-slider">
            Percentage of invisible pieces per turn
          </label>
          <div class="setting-row">
            <input
              id="setup-blind-slider"
              class="dilution-slider"
              type="range"
              min="0"
              max="20"
              step="1"
              value="10"
            />
            <span id="setup-blind-value">10%</span>
          </div>
          <label class="setting-checkbox">
            <input id="setup-blind-to-your-pieces" type="checkbox" checked />
            <span>Blind to your pieces</span>
          </label>
          <label class="setting-checkbox">
            <input id="setup-blind-to-own-pieces" type="checkbox" checked />
            <span>Blind to its own pieces</span>
          </label>
          <label class="setting-checkbox">
            <input id="setup-never-blind-last-moved" type="checkbox" checked />
            <span>Never blind to the last moved piece</span>
          </label>
          <label class="setting-checkbox">
            <input id="setup-reveal-blindness" type="checkbox" checked />
            <span>Reveal Blindness</span>
          </label>
        </div>

        <label class="setting-label" for="setup-color-select">Play as</label>
        <select id="setup-color-select" class="setup-select">
          <option value="random" selected>Random</option>
          <option value="w">White</option>
          <option value="b">Black</option>
        </select>

        <div class="setup-actions">
          <button id="setup-back-btn" type="button">Back</button>
          <button id="setup-start-btn" type="button">Start Game</button>
        </div>
      </div>
    </section>

    <main id="game-app" class="app app-hidden">
      <header class="topbar">
        <h1>Blunderfish</h1>
        <div class="controls">
          <button id="new-game-btn" type="button">New Game</button>
          <button id="flip-board-btn" type="button">Flip Board</button>
          <button id="export-fen-btn" type="button">Export FEN</button>
        </div>
      </header>
      <p class="subtitle">
        Max difficulty stockfish but it is forced to randomly play blunders
      </p>

      <section class="status-wrap">
        <p id="status-text" aria-live="polite"></p>
      </section>

      <section class="play-area">
        <div class="board-wrap">
          <section id="eval-bar-wrap" class="eval-bar-wrap" aria-label="Evaluation bar" hidden>
            <div class="eval-bar" role="img" aria-label="Position evaluation">
              <div id="eval-bar-white-fill" class="eval-bar-white-fill" style="width: 50%"></div>
            </div>
            <span id="eval-bar-label" class="eval-bar-label">0.00</span>
          </section>
          <div id="board" class="board" aria-label="Chess board"></div>
        </div>
        <aside class="right-column" aria-label="Controls and move list">
          <section class="captures-panel" aria-label="Captures">
            <h2>Captures</h2>
            <div class="capture-row">
              <span class="capture-label">Opponent</span>
              <div id="opponent-captures" class="capture-icons"></div>
              <span id="opponent-capture-score" class="capture-score">+0</span>
            </div>
            <div class="capture-row">
              <span class="capture-label">You</span>
              <div id="your-captures" class="capture-icons"></div>
              <span id="your-capture-score" class="capture-score">+0</span>
            </div>
          </section>

          <section class="settings-panel" aria-label="Settings">
            <h2>Settings</h2>
            <label id="setting-label" class="setting-label" for="blunder-slider">
              Blunder Chance
            </label>
            <div class="setting-row">
              <input
                id="blunder-slider"
                class="dilution-slider"
                type="range"
                min="0"
                max="100"
                step="1"
                value="20"
              />
              <input
                id="blunder-input"
                class="dilution-input"
                type="number"
                min="0"
                max="100"
                step="1"
                value="20"
                inputmode="numeric"
                aria-label="Blunder chance percentage"
              />
              <span id="setting-percent-symbol" class="percent-symbol">%</span>
            </div>
            <label class="setting-checkbox">
              <input id="blind-to-your-pieces" type="checkbox" checked />
              <span>Blind to your pieces</span>
            </label>
            <label class="setting-checkbox">
              <input id="blind-to-own-pieces" type="checkbox" checked />
              <span>Blind to its own pieces</span>
            </label>
            <label class="setting-checkbox">
              <input id="never-blind-last-moved" type="checkbox" checked />
              <span>Never blind to the last moved piece</span>
            </label>
            <label class="setting-checkbox">
              <input id="reveal-blunders" type="checkbox" checked />
              <span id="reveal-setting-label">Reveal Blunders</span>
            </label>
            <label class="setting-checkbox">
              <input id="show-eval-bar" type="checkbox" checked />
              <span>Show eval bar</span>
            </label>
            <div id="ramp-readonly-settings" class="ramp-readonly" hidden>
              <p class="ramp-readonly-row"><strong>Current engine goal:</strong> <span id="ramp-target-cp-value">White +20.00</span></p>
            </div>
          </section>

          <section class="moves-panel" aria-label="Move list">
            <h2>Moves</h2>
            <div class="moves-table-wrap">
              <table class="moves-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>White</th>
                    <th>Black</th>
                  </tr>
                </thead>
                <tbody id="moves-body"></tbody>
              </table>
            </div>
          </section>
        </aside>
      </section>
      
      <footer class="footer">
        <a href="./CREDITS.md" target="_blank" rel="noreferrer">Asset and engine credits</a>
      </footer>
    </main>

    <dialog id="promotion-dialog" class="promotion-dialog">
      <form method="dialog">
        <h2>Choose promotion</h2>
        <div id="promotion-options" class="promotion-options"></div>
      </form>
    </dialog>

    <dialog id="game-result-dialog" class="game-result-dialog">
      <div class="game-result-header">
        <h2 id="game-result-title">Draw!</h2>
        <button id="game-result-close-btn" type="button" aria-label="Close game result">X</button>
      </div>
      <div class="game-result-graph-wrap">
        <p id="game-result-graph-y-label" class="game-result-axis-label">Eval (pawns, human perspective)</p>
        <svg
          id="game-result-graph"
          class="game-result-graph"
          viewBox="0 0 680 280"
          role="img"
          aria-label="Eval history graph"
        ></svg>
        <p id="game-result-graph-x-label" class="game-result-axis-label">Half-move (ply)</p>
      </div>
      <div class="game-result-actions">
        <button id="game-result-main-menu-btn" type="button">Main Menu</button>
        <button id="game-result-rematch-btn" type="button">Rematch</button>
      </div>
    </dialog>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
